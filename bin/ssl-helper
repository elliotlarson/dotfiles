#!/bin/bash

ACTION=$1
DOMAIN=$2

color_red=$(tput setaf 1)
color_green=$(tput setaf 2)
color_yellow=$(tput setaf 3)
color_reset=$(tput sgr0)

usage() {
  echo "Usage: $0 {action} {domain}"
}

if [ ! $DOMAIN ]; then
  echo "${color_red}ERROR: Please provide a domain.${color_reset}"
  usage
  exit 1
fi

create_certificate() {
  openssl genrsa -out ${DOMAIN}.key 2048
  openssl req -new -nodes -sha256 -key ${DOMAIN}.key -out ${DOMAIN}.csr 
}

case $ACTION in
  create)
    create_certificate
    echo "${color_green}=> created certificate signing request${color_reset}"
    cat ${DOMAIN}.csr
    ;;
  compile-comodo)
    echo "compiling comodo cert for $DOMAIN"
    ;;
  *)
    usage
    exit 1
    ;;
esac
